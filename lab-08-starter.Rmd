---
title: "Lab 08 - Quantifying Uncertainty"
author: "Catherine O'Reilly"
date: "4/27/23"
output: html_document
---

### Load packages and data

```{r load-packages, message = FALSE}
library(tidyverse)
library(tidymodels)
library(lubridate)
```

## Exercises

### Exercise 1

The name of the file we need to load is us-mms-simple.csv and it is a csv file.

```{r import-data}
fluxes <- read_csv("data/us-mms-simple.csv")
```

## Fix dates

```{r fix-dates, eval = F}
fluxes <- fluxes %>% 
  mutate(date = mdy_hm(date))
head(fluxes)
```

### Exercise 2

```{r subset-fluxes, eval = T}
fluxes_subset <- fluxes %>% 
  filter(date > "2020-06-01" & date < "2020-06-30") %>% 
  select(date, fco2, evaporation)
head(fluxes_subset, 10) 
```

### Exercise 3

``` {r counting number of rows}
nrow(fluxes_subset)
```
There are 695 observations in June 2020, with each row representing a specific hour of a day.

### Exercise 4

Defining our underlying population as summertime, the month of June (the sample I have chosen) would likely be a good representative of that population. Because fco2 fluxes vary drastically across the seasons, the month of June would not be a good representative of the entire year-round fco2 fluxes, but because we are defining the overall population as just the summertime season, the month of June would be a good sample. 

### Exercise 5

``` {r fitting a linear model}
linear_reg() %>% 
  set_engine("lm") %>% 
  fit(fco2 ~ evaporation, data = fluxes_subset) %>% 
  tidy()
```

For every unit increase in evaporation, the fco2 value increases by 1.146 units.

### Exercise 6

```{r randomoize-and-slice, eval = T}
monroe_June_subsample <- fluxes_subset %>% 
  mutate(row = 1:n(),
         rrow = sample(row, size = n(), replace  = F)) %>% 
  arrange(rrow) %>% 
  slice_head(n=139)
```

The first row of the code is naming our new data object as monroe_June_subsample and setting up our pipeline with fluxes_subset. The next line of code uses the mutate function to create a column titled row which labels each row starting at 1 and going until 695 and to create a column called rrow which randomly samples from row without replacing the values. Then rrow is arranged in order from least to greatest, and using slice_head() allows us to keep the first 20% of the data. 

### Exercise 7

We will now step you through generating bootstrap samples.

7.  Take 1000 bootstrap samples. Call your new object `monroe_MONTH_boot`

```{r create-bootstraps, eval = T}
monroe_June_boot <- bootstraps(monroe_June_subsample, times = 1000)
```

### Exercise 8

8.  For each sample: fit a model and save output in model column. Tidy model output and save in coef_info column. Call your new model object `monroe_MONTH_models`.

```{r fit-models, eval = T}
monroe_June_models <- monroe_June_boot%>%
  mutate(
    model = map(splits, ~ lm(fco2 ~ evaporation, data = .)),
    coef_info = map(model, tidy)
  )
```

### Exercise 9

Remove this text, and add your answer for Exercise 9 here.

### Exercise 10

Remove this text, and add your answer for Exercise 10 here.

### Exercise 11

Remove this text, and add your answer for Exercise 11 here.

### Exercise 12

Remove this text, and add your answer for Exercise 12 here.

### Exercise 13

Remove this text, and add your answer for Exercise 13 here.

